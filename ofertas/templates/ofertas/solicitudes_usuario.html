{% extends "layout.html" %}

{% block content %}
  <h2>Mis Solicitudes</h2>
  <table>
    <thead>
      <tr>
        <th>Programa</th>
        <th>Fecha de creación</th>
        <th>Estado</th>
        <th>Acciones</th>  {# 👈 NUEVA COLUMNA #}
      </tr>
    </thead>
    <tbody>
      {% for solicitud in solicitudes %}
        <tr>
          <td>{{ solicitud.programa.nombre }}</td>
          <td>{{ solicitud.creado_en|date:"Y-m-d H:i" }}</td>
          <td>{{ solicitud.estado.nombre }}</td>
          <td>
            {# 👇 ACCIONES SEGÚN ROL #}
            {% if grupo_nombre == "Instructor" %}
              <!-- Formulario para subir cédula en PDF -->
              <a href="{% url 'ofertas:subir_cedula' solicitud.id %}">📄 Subir Cédulas</a>
              {% if solicitud.archivo_cedula_pdf %}
                <br><a href="{{ solicitud.archivo_cedula_pdf.url }}" target="_blank">Ver archivo</a>
              {% endif %}

            {% elif grupo_nombre == "Funcionario" or grupo_nombre == "Coordinador" %}
              <!-- Formulario para cambiar estado o comentar -->
              <a href="{% url 'ofertas:editar_estado_comentario' oferta_id=solicitud.id %}">✏️ Editar Estado</a>
            {% endif %}
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="4">No has enviado solicitudes.</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
